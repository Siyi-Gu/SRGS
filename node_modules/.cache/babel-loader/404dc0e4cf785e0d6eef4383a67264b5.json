{"ast":null,"code":"import _objectSpread from \"/home/sigu3507/dialogue/SRGS-lab4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { send, assign } from \"xstate\"; // SRGS parser and example (logs the results to console on page load)\n\nimport { loadGrammar } from './runparser';\nimport { parse } from './chartparser';\nimport { grammar } from './grammars/intelligentGrammar';\nconst gram = loadGrammar(grammar); //const input = \"I would like a coca cola and three large pizzas with pepperoni and mushrooms\"\n//const prs = parse(input.split(/\\s+/), gram)\n//const result = prs.resultsForRule(gram.$root)[0]\n//console.log(result)\n\nfunction parsing(recResult) {\n  let prs = parse(recResult.split(/\\s+/), gram);\n  return prs.resultsForRule(gram.$root)[0];\n}\n\nfunction say(text) {\n  return send(_context => ({\n    type: \"SPEAK\",\n    value: text\n  }));\n}\n\nfunction promptAndAsk(prompt) {\n  return {\n    initial: 'prompt',\n    states: {\n      prompt: {\n        entry: say(prompt),\n        on: {\n          ENDSPEECH: 'ask'\n        }\n      },\n      ask: {\n        entry: send('LISTEN')\n      }\n    }\n  };\n}\n\nexport const dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'welcome'\n      }\n    },\n    welcome: _objectSpread({\n      initial: \"prompt\",\n      on: {\n        RECOGNISED: {\n          target: 'confirm',\n          actions: assign(context => {\n            return {\n              smarthome: parsing(context.recResult)\n            };\n          })\n        }\n      }\n    }, promptAndAsk(\"What can I do for you?\")),\n    confirm: {\n      initial: 'prompt',\n      states: {\n        prompt: {\n          entry: send(context => ({\n            type: \"SPEAK\",\n            value: \"OK. \".concat(context.smarthome.action, \" \").concat(context.smarthome.object, \".\")\n          }))\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/home/sigu3507/dialogue/SRGS-lab4/src/dmSmartHome.ts"],"names":["send","assign","loadGrammar","parse","grammar","gram","parsing","recResult","prs","split","resultsForRule","$root","say","text","_context","type","value","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","dmMachine","init","CLICK","welcome","RECOGNISED","target","actions","context","smarthome","confirm","action","object"],"mappings":";AAAA,SAAwBA,IAAxB,EAAsCC,MAAtC,QAAoD,QAApD,C,CAEA;;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,SAASC,OAAT,QAAwB,+BAAxB;AAGA,MAAMC,IAAI,GAAGH,WAAW,CAACE,OAAD,CAAxB,C,CACA;AACA;AACA;AAEA;;AAEA,SAASE,OAAT,CAAiBC,SAAjB,EAAmC;AAC/B,MAAIC,GAAG,GAAGL,KAAK,CAACI,SAAS,CAACE,KAAV,CAAgB,KAAhB,CAAD,EAAyBJ,IAAzB,CAAf;AACA,SAAOG,GAAG,CAACE,cAAJ,CAAmBL,IAAI,CAACM,KAAxB,EAA+B,CAA/B,CAAP;AACH;;AAED,SAASC,GAAT,CAAaC,IAAb,EAAyD;AACrD,SAAOb,IAAI,CAAEc,QAAD,KAA2B;AAAEC,IAAAA,IAAI,EAAE,OAAR;AAAiBC,IAAAA,KAAK,EAAEH;AAAxB,GAA3B,CAAD,CAAX;AACH;;AAED,SAASI,YAAT,CAAsBC,MAAtB,EAAgF;AAC5E,SAAQ;AACJC,IAAAA,OAAO,EAAE,QADL;AAEJC,IAAAA,MAAM,EAAE;AACJF,MAAAA,MAAM,EAAE;AACJG,QAAAA,KAAK,EAAET,GAAG,CAACM,MAAD,CADN;AAEJI,QAAAA,EAAE,EAAE;AAAEC,UAAAA,SAAS,EAAE;AAAb;AAFA,OADJ;AAKJC,MAAAA,GAAG,EAAE;AACDH,QAAAA,KAAK,EAAErB,IAAI,CAAC,QAAD;AADV;AALD;AAFJ,GAAR;AAYH;;AAGD,OAAO,MAAMyB,SAAmD,GAAI;AAChEN,EAAAA,OAAO,EAAE,MADuD;AAEhEC,EAAAA,MAAM,EAAE;AACJM,IAAAA,IAAI,EAAE;AACFJ,MAAAA,EAAE,EAAE;AACAK,QAAAA,KAAK,EAAE;AADP;AADF,KADF;AAMJC,IAAAA,OAAO;AACHT,MAAAA,OAAO,EAAE,QADN;AAEHG,MAAAA,EAAE,EAAE;AACAO,QAAAA,UAAU,EAAE;AACNC,UAAAA,MAAM,EAAE,SADF;AAENC,UAAAA,OAAO,EAAE9B,MAAM,CAAE+B,OAAD,IAAa;AAAE,mBAAO;AAAEC,cAAAA,SAAS,EAAE3B,OAAO,CAAC0B,OAAO,CAACzB,SAAT;AAApB,aAAP;AAAkD,WAAlE;AAFT;AADZ;AAFD,OAQAU,YAAY,CAAC,wBAAD,CARZ,CANH;AAgBJiB,IAAAA,OAAO,EAAE;AACLf,MAAAA,OAAO,EAAE,QADJ;AAELC,MAAAA,MAAM,EAAE;AACJF,QAAAA,MAAM,EAAE;AACJG,UAAAA,KAAK,EAAErB,IAAI,CAAEgC,OAAD,KAAc;AACtBjB,YAAAA,IAAI,EAAE,OADgB;AAEtBC,YAAAA,KAAK,gBAASgB,OAAO,CAACC,SAAR,CAAkBE,MAA3B,cAAqCH,OAAO,CAACC,SAAR,CAAkBG,MAAvD;AAFiB,WAAd,CAAD;AADP;AADJ;AAFH;AAhBL;AAFwD,CAA7D","sourcesContent":["import { MachineConfig, send, Action, assign } from \"xstate\";\n\n// SRGS parser and example (logs the results to console on page load)\nimport { loadGrammar } from './runparser'\nimport { parse } from './chartparser'\nimport { grammar } from './grammars/intelligentGrammar'\n\n\nconst gram = loadGrammar(grammar)\n//const input = \"I would like a coca cola and three large pizzas with pepperoni and mushrooms\"\n//const prs = parse(input.split(/\\s+/), gram)\n//const result = prs.resultsForRule(gram.$root)[0]\n\n//console.log(result)\n\nfunction parsing(recResult: string){\n    let prs = parse(recResult.split(/\\s+/), gram)\n    return prs.resultsForRule(gram.$root)[0]\n}\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: send('LISTEN'),\n            },\n        }\n    })\n}\n\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            initial: \"prompt\",\n            on: {\n                RECOGNISED: {\n                      target: 'confirm',\n                      actions: assign((context) => { return { smarthome: parsing(context.recResult) } }),\n                }\n            },\n            ...promptAndAsk(\"What can I do for you?\")\n        },\n        confirm: {\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: send((context) => ({\n                        type: \"SPEAK\",\n                        value: `OK. ${context.smarthome.action} ${context.smarthome.object}.`\n                    }))\n                },\n            }\n        }\n    }\n})\n"]},"metadata":{},"sourceType":"module"}